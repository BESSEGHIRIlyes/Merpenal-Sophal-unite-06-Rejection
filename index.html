<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Test Simulation</title>
</head>
<body>
  <h1>✅ Mon simulateur est en ligne !</h1>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merpenal Sophal 40mg Vials Rejection</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f4f8;
            color: #333;
            padding: 20px;
            line-height: 1.6;
            position: relative;
            min-height: 100vh;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 50px;
        }
        .header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            position: relative;
        }
        h1 {
            color: #1e3a8a;
            text-align: center;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 10px;
            flex-grow: 1;
        }
        h2 {
            color: #2563eb;
            margin-top: 25px;
        }
        .step {
            border: 1px solid #d1d5db;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            background-color: #f8fafc;
        }
        label {
            display: block;
            margin-top: 10px;
            font-weight: bold;
            color: #4b5563;
        }
        input[type="number"], button {
            width: calc(100% - 22px);
            padding: 10px;
            margin-top: 5px;
            border-radius: 5px;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }
        .input-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .input-group > div {
            flex: 1;
            min-width: 200px;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin-top: 25px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .results {
            margin-top: 20px;
            padding: 15px;
            background-color: #e3f2fd;
            border-left: 5px solid #2196f3;
            border-radius: 5px;
        }
        .results p {
            margin: 5px 0;
            font-size: 1em;
        }
        .warning {
            color: #e53e3e;
            font-weight: bold;
        }
        .success {
            color: #38a169;
            font-weight: bold;
        }
        .made-by {
            position: absolute;
            bottom: 10px;
            right: 20px;
            font-size: 0.8em;
            color: #6b7280;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Merpenal Sophal 40mg Vials Rejection</h1>
        </div>

        <div class="step">
            <h2>1. Vials Washing Machine</h2>
            <div class="input-group">
                <div>
                    <label for="inputA_washing">A - Vials Input :</label>
                    <input type="number" id="inputA_washing" value="104040">
                </div>
                <div>
                    <label for="inputC_washing">C - Returned to Stock :</label>
                    <input type="number" id="inputC_washing" value="0">
                </div>
                <div>
                    <label for="inputD_washing">D - Good vials for Tunnel :</label>
                    <input type="number" id="inputD_washing" value="102400">
                </div>
            </div>
            <div class="results" id="results-washing"></div>
        </div>

        <div class="step">
            <h2>2. Sterilization Tunnel</h2>
            <div class="input-group">
                <div>
                    <label>A - Input of tunnel (D from Washing) :</label>
                    <input type="number" id="inputA_steril" readonly>
                </div>
                <div>
                    <label for="inputC_steril">C - Good Vials for Filling :</label>
                    <input type="number" id="inputC_steril" value="97500">
                </div>
            </div>
            <div class="results" id="results-steril"></div>
        </div>

        <div class="step">
            <h2>3. Filling Machine</h2>
            <div class="input-group">
                <div>
                    <label>A - Available vials (C from Sterilization) :</label>
                    <input type="number" id="inputA_filling" readonly>
                </div>
                <div>
                    <label for="inputD_filling">D - IPC :</label>
                    <input type="number" id="inputD_filling" value="288">
                </div>
                <div>
                    <label for="inputE_filling">E - Vials loading to Lyophilizer :</label>
                    <input type="number" id="inputE_filling" value="93248">
                </div>
            </div>
            <div class="results" id="results-filling"></div>
        </div>

        <div class="step">
            <h2>4. Capping / Sealing Machine</h2>
            <div class="input-group">
                <div>
                    <label for="inputA_capping">A - Input Capping :</label>
                    <input type="number" id="inputA_capping" value="91660">
                </div>
                <div>
                    <label for="inputB_capping">B - Rejection :</label>
                    <input type="number" id="inputB_capping" value="660">
                </div>
                <div>
                    <label for="inputC_capping">C - IPC :</label>
                    <input type="number" id="inputC_capping" value="0">
                </div>
                <div>
                    <label for="inputD_capping">D - Output Capping :</label>
                    <input type="number" id="inputD_capping" value="91000">
                </div>
            </div>
            <div class="results" id="results-capping"></div>
        </div>

        <div class="step">
            <h2>5. Automatic Inspection Machine (AIM)</h2>
            <div class="input-group">
                <div>
                    <label for="inputA_auto">A - Input of AIM :</label>
                    <input type="number" id="inputA_auto" value="89000">
                </div>
                <div>
                    <label for="inputB_auto">B - IPC :</label>
                    <input type="number" id="inputB_auto" value="275">
                </div>
                <div>
                    <label for="input_a_auto">a - Input for Visual Inspection :</label>
                    <input type="number" id="input_a_auto" value="4650">
                </div>
            </div>
            <div class="results" id="results-auto"></div>
        </div>
        
        <div class="step">
            <h2>6. Visual Inspection</h2>
            <div class="input-group">
                <div>
                    <label>A - Input (a from C AIM) :</label>
                    <input type="number" id="inputA_visual" readonly>
                </div>
                <div>
                    <label for="inputB_visual">B - IPC :</label>
                    <input type="number" id="inputB_visual" value="0">
                </div>
                <div>
                    <label for="inputD_visual">D - Qualified Vials from Visual Inspection :</label>
                    <input type="number" id="inputD_visual" value="4000">
                </div>
            </div>
            <div class="results" id="results-visual"></div>
        </div>
        
        <div class="step">
            <h2>7. Final Packaging</h2>
            <div class="input-group">
                <div>
                    <label for="inputH_packaging">H - Good Vials for Packaging :</label>
                    <input type="number" id="inputH_packaging" value="84000">
                </div>
            </div>
        </div>

        <button onclick="calculate()">Calculate All Steps</button>

    </div>
    <div class="made-by">Made by BESSEGHIR Ilyes</div>

    <script>
        // Fonction pour générer un nombre entier aléatoire dans un intervalle [min, max]
        function getRandomInt(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function calculate() {
            // ---- Step 1: Vials Washing Machine ----
            const A1 = parseFloat(document.getElementById('inputA_washing').value);
            const C1 = parseFloat(document.getElementById('inputC_washing').value);
            const D1 = parseFloat(document.getElementById('inputD_washing').value);
            
            const remainingForBD = A1 - C1 - D1;
            let B1 = getRandomInt(121, 245);
            let E1 = remainingForBD - B1;
            
            if (B1 > 200) {
                B1 = 200;
                E1 = remainingForBD - B1;
            }

            const rendement1 = ((B1 + C1 + D1 + E1) / A1) * 100;
            
            const results1 = document.getElementById('results-washing');
            results1.innerHTML = `
                <p><strong>B - Rejected during washing:</strong> ${B1}</p>
                <p><strong>E - Vials discarded or remaining:</strong> ${E1}</p>
                <p><strong>Yield:</strong> ${rendement1.toFixed(2)}% ${rendement1 === 100 ? ' (OK)' : ' (Problème)'}</p>
            `;
            document.getElementById('inputA_steril').value = D1;

            // ---- Step 2: Sterilization Tunnel ----
            const A2 = parseFloat(document.getElementById('inputA_steril').value);
            const C2 = parseFloat(document.getElementById('inputC_steril').value);
            const B2 = getRandomInt(10, 28);
            const D2 = A2 - B2 - C2;
            const rendement2 = ((B2 + C2 + D2) / A2) * 100;

            const results2 = document.getElementById('results-steril');
            results2.innerHTML = `
                <p><strong>B - Rejected during sterilization:</strong> ${B2}</p>
                <p><strong>D - Vials discarded or remaining:</strong> ${D2}</p>
                <p><strong>Yield:</strong> ${rendement2.toFixed(2)}% ${rendement2 >= 99 ? ' (OK)' : ' (Problème)'}</p>
            `;
            document.getElementById('inputA_filling').value = C2;

            // ---- Step 3: Filling Machine ----
            const A3 = parseFloat(document.getElementById('inputA_filling').value);
            const D3 = parseFloat(document.getElementById('inputD_filling').value);
            const E3 = parseFloat(document.getElementById('inputE_filling').value);
            const a3 = 2000;

            let B3;
            const C3_preliminary = A3 - D3 - E3;
            if (C3_preliminary > 3500) {
                B3 = getRandomInt(500, 800);
            } else {
                B3 = getRandomInt(300, 500);
            }
            
            const C3_available = A3 - B3 - D3 - E3;
            const C3 = Math.max(0, C3_available);

            const C3_distributable = C3 - a3;
            const b3 = Math.floor(C3_distributable * 0.2);
            const c3 = Math.floor(C3_distributable * 0.25);
            const d3 = Math.floor(C3_distributable * 0.35);
            const e3 = C3_distributable - b3 - c3 - d3;

            const totalSumForYield3 = B3 + C3 + D3 + E3;
            const rendement3 = (totalSumForYield3 / A3) * 100;

            const A4_fromInput = parseFloat(document.getElementById('inputA_capping').value);
            const F = E3 - A4_fromInput;

            const results3 = document.getElementById('results-filling');
            results3.innerHTML = `
                <p><strong>B - Turn Table:</strong> ${B3}</p>
                <p><strong>C - Filling Total Rejection:</strong> ${C3}</p>
                <p style="margin-left: 20px;">- a (Flushing): ${a3}</p>
                <p style="margin-left: 20px;">- b (ALUS Empty vials): ${b3}</p>
                <p style="margin-left: 20px;">- c (ALUS Filled vials): ${c3}</p>
                <p style="margin-left: 20px;">- d (Fallen or removed): ${d3}</p>
                <p style="margin-left: 20px;">- e (Left over Empty vials): ${e3}</p>
                <p><strong>Yield:</strong> ${rendement3.toFixed(2)}% ${rendement3 >= 99 ? ' (OK)' : ' (Problème)'}</p>
                <p><strong>F - Empty vials removed (Lyo to Capping):</strong> ${F}</p>
            `;

            // ---- Step 4: Capping / Sealing Machine ----
            const A4 = parseFloat(document.getElementById('inputA_capping').value);
            const B4 = parseFloat(document.getElementById('inputB_capping').value);
            const C4 = parseFloat(document.getElementById('inputC_capping').value);
            const D4 = parseFloat(document.getElementById('inputD_capping').value);
            
            const rendement4 = ((B4 + C4 + D4) / A4) * 100;

            const A5_fromInput = parseFloat(document.getElementById('inputA_auto').value);
            const G = D4 - A5_fromInput;

            const results4 = document.getElementById('results-capping');
            results4.innerHTML = `
                <p><strong>Yield:</strong> ${rendement4.toFixed(2)}% ${rendement4 >= 99 ? ' (OK)' : ' (Problème)'}</p>
                <p><strong>G - Empty vials removed (Capping to AIM):</strong> ${G}</p>
            `;

            // ---- Step 5: Automatic Inspection Machine (AIM) ----
            const A5 = parseFloat(document.getElementById('inputA_auto').value);
            const B5 = parseFloat(document.getElementById('inputB_auto').value);
            const a5_input = parseFloat(document.getElementById('input_a_auto').value);
            
            const H = parseFloat(document.getElementById('inputH_packaging').value);
            const D6_fromInput = parseFloat(document.getElementById('inputD_visual').value);
            
            const D5 = H - D6_fromInput;

            const C5 = A5 - B5 - D5;
            const b5 = C5 - a5_input;

            const rendement5 = ((B5 + C5 + D5) / A5) * 100;

            const results5 = document.getElementById('results-auto');
            results5.innerHTML = `
                <p><strong>D - Qualified Vials:</strong> ${D5}</p>
                <p><strong>C - AIM Total Rejection:</strong> ${C5}</p>
                <p style="margin-left: 20px;">- a (Input for Visual Inspection): ${a5_input}</p>
                <p style="margin-left: 20px;">- b (Rejected vials): ${b5}</p>
                <p><strong>Yield:</strong> ${rendement5.toFixed(2)}% ${rendement5 >= 99 ? ' (OK)' : ' (Problème)'}</p>
            `;
            document.getElementById('inputA_visual').value = a5_input;

            // ---- Step 6: Visual Inspection ----
            const A6 = parseFloat(document.getElementById('inputA_visual').value);
            const B6 = parseFloat(document.getElementById('inputB_visual').value);
            const D6 = parseFloat(document.getElementById('inputD_visual').value);
            
            const C6 = A6 - B6 - D6;

            const rendement6 = ((B6 + C6 + D6) / A6) * 100;

            const results6 = document.getElementById('results-visual');
            results6.innerHTML = `
                <p><strong>C - Visual Inspection Rejection:</strong> ${C6}</p>
                <p><strong>Yield:</strong> ${rendement6.toFixed(2)}% ${rendement6 >= 99 ? ' (OK)' : ' (Problème)'}</p>
            `;
        }
    </script>
</body>
</html>
